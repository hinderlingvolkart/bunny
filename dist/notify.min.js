var NotifyConfig = {
  useAnimation: true,
  defaultPosition: 'top-right',
  defaultType: 'success',
  classSlideRight: 'slide-right',
  classSlideInLeft: 'slide-in-left',
  tagName: 'alert',
  tagNameContainer: 'notifies',
  attrType: 'brand',
  attrPosition: 'fixed',
  classNameCloser: 'close',
  autoRemoveAfter: 2 //seconds; 0 - do not remove automatically
};

var Notify = {

  Config: NotifyConfig,

  setType: function setType(alert, type) {
    alert.setAttribute(this.Config.attrType, type);
  },
  setPosition: function setPosition(alert, position) {
    alert.setAttribute(this.Config.attrPosition, position);
  },
  show: function show(alert) {
    alert.classList.add(this.Config.classSlideInLeft);
  },
  hide: function hide(alert) {
    alert.classList.add(this.Config.classSlideRight);
  },
  remove: function remove(alert) {
    alert.parentNode.removeChild(alert);
    this.fireOnRemove(alert);
  },
  hideAndRemove: function hideAndRemove(alert) {
    var _this = this;

    this.hide(alert);
    if (this.Config.useAnimation) {
      alert.addEventListener('animationend', function () {
        _this.remove(alert);
      });
    } else {
      this.remove(alert);
    }
  },
  create: function create(message) {
    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.Config.defaultType;
    var position = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.Config.defaultPosition;
    var insideContainer = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

    var alert = document.createElement(this.Config.tagName);
    alert.innerHTML = message;
    this.setType(alert, type);
    if (insideContainer) {
      var container = this.getContainer();
      if (container === false) {
        container = this.createContainer(position);
        document.body.appendChild(container);
      }
    } else {
      this.setPosition(alert, position);
    }
    return alert;
  },
  createCloser: function createCloser() {
    var btn = document.createElement('button');
    btn.type = 'button';
    btn.className = this.Config.classNameCloser;
    btn.dataset.dismiss = 'alert';
    btn.setAttribute('aria-label', 'Close');
    return btn;
  },
  createAndInit: function createAndInit(message) {
    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.Config.defaultType;
    var position = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.Config.defaultPosition;
    var insideContainer = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    var autoRemoveAfter = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : this.Config.autoRemoveAfter;

    var alert = this.create(message, type, position, insideContainer);
    if (insideContainer) {
      this.getContainer().appendChild(alert);
    } else {
      document.body.appendChild(alert);
    }
    this.show(alert);
    this.addEvents(alert, autoRemoveAfter);
  },
  createContainer: function createContainer() {
    var position = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.Config.defaultPosition;

    var el = document.createElement(this.Config.tagNameContainer);
    this.setPosition(el, position);
    return el;
  },
  hasContainer: function hasContainer(alert) {
    return alert.parentNode.tagName === this.Config.tagNameContainer;
  },
  getContainer: function getContainer() {
    return document.getElementsByTagName(this.Config.tagNameContainer)[0] || false;
  },
  getCloser: function getCloser(alert) {
    return alert.getElementsByClassName(this.Config.classNameCloser)[0] || false;
  },
  addEvents: function addEvents(alert) {
    var _this2 = this;

    var autoRemoveAfter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.Config.autoRemoveAfter;

    alert.addEventListener('click', function () {
      _this2.hideAndRemove(alert);
    });
    if (autoRemoveAfter > 0) {
      setTimeout(function () {
        _this2.hideAndRemove(alert);
      }, autoRemoveAfter * 1000);
    }
  },
  onRemove: function onRemove(alert, callback) {
    if (alert.__notify_cb === undefined) {
      alert.__notify_cb = [];
    }
    alert.__notify_cb.push(callback);
  },
  fireOnRemove: function fireOnRemove(alert) {
    if (alert.__notify_cb !== undefined) {
      alert.__notify_cb.forEach(function (cb) {
        cb();
      });
    }
  },
  success: function success(message) {
    var autoRemoveAfter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.Config.autoRemoveAfter;

    this.createAndInit(message, 'success', this.Config.defaultPosition, true, autoRemoveAfter);
  },
  info: function info(message) {
    var autoRemoveAfter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.Config.autoRemoveAfter;

    this.createAndInit(message, 'info', this.Config.defaultPosition, true, autoRemoveAfter);
  },
  warning: function warning(message) {
    var autoRemoveAfter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.Config.autoRemoveAfter;

    this.createAndInit(message, 'warning', this.Config.defaultPosition, true, autoRemoveAfter);
  },
  danger: function danger(message) {
    var autoRemoveAfter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.Config.autoRemoveAfter;

    this.createAndInit(message, 'danger', this.Config.defaultPosition, true, autoRemoveAfter);
  }
};

